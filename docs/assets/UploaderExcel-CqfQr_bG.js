import{t as e}from"./select-B929XeFB.js";import{t}from"./floatlabel-WHqg0b3B.js";import{Dt as n,Et as r,J as i,Lt as a,Ut as o,Vt as s,Wt as c,X as l,Y as u,Z as d,et as f,gt as p,lt as m,q as h,qt as g,rt as _,tt as v,wt as y,yt as b}from"./index-iuVyTblz.js";var x={class:`border-divide radius nodrag animate flex w-full cursor-pointer flex-col items-center gap-2 border p-4 hover:animate-pulse`},S=[`textContent`],C={key:1,class:`inline-flex gap-2 text-4xl`},w=_({__name:`UploaderExcel`,props:m({rootClass:{}},{selectedValue:{required:!0},selectedValueModifiers:{}}),emits:[`update:selectedValue`],setup(m){let{rootClass:_}=s(m),w=y(m,`selectedValue`),T=a({type:``,name:``}),E=a(),D=h(()=>{let e=[];if(E.value){let t=Object.keys(E.value);for(let n=0;n<t.length;n++){let r=t[n];e.push({text:r,value:r})}}return e}),O=a(null),k=e=>{w.value=e},A=async e=>{let t=URL.createObjectURL(e);return await fetch(t).then(e=>e.arrayBuffer()).then(e=>{let t=window.XLSX.read(e,{type:`binary`,codepage:65001}),n={};for(let e=0;e<t.SheetNames.length;e++)n[t.SheetNames[e]]=window.XLSX.utils.sheet_to_json(t.Sheets[t.SheetNames[e]]);return n})},j=async e=>{let{files:t}=e.target;if(!t||!t.length)return;let{name:n,type:r}=t[0];Object.assign(T.value,{name:n,type:r}),E.value=await A(t[0])};return r(O,e=>{e&&k(E.value[e])}),(r,a)=>(p(),d(`div`,{class:c([`wrap--gap flex flex-col`,o(_)])},[b(r.$slots,`header`),i(`label`,x,[T.value.name.length>0?(p(),d(`strong`,{key:0,class:`text-sm`,textContent:g(T.value.name)},null,8,S)):(p(),d(`span`,C,[...a[2]||=[i(`i`,{class:`bi bi-filetype-csv leading-none`},null,-1),i(`i`,{class:`bi bi-filetype-xls leading-none`},null,-1),i(`i`,{class:`bi bi-filetype-xlsx leading-none`},null,-1)]])),a[3]||=i(`span`,{class:`text-xs`},[i(`strong`,{class:`text-main text-sm`},`點擊`),f(`載入檔案`)],-1),i(`input`,{type:`file`,hidden:``,multiple:``,accept:`text/csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet`,onChange:a[0]||=e=>j(e)},null,32)]),E.value?(p(),u(o(t),{key:0,variant:`on`},{default:n(()=>[v(o(e),{size:`small`,inputId:`sheetsList`,options:D.value,optionLabel:`text`,optionValue:`value`,class:`nodrag nowheel w-full`,modelValue:O.value,"onUpdate:modelValue":a[1]||=e=>O.value=e},null,8,[`options`,`modelValue`]),a[4]||=i(`label`,{for:`sheetsList`,class:`form__label`},`工作表`,-1)]),_:1})):l(``,!0)],2))}});export{w as default};