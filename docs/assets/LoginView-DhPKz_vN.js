import{r as e,t}from"./floatlabel-OElZ2uia.js";import{n,r,t as i}from"./api-CvHUBlCF.js";import{B as a,Dt as o,J as s,Lt as c,Ut as l,W as u,X as d,Y as f,a as p,et as m,gt as h,m as g,q as _,qt as v,rt as y,tt as b}from"./index-Bu07tFg0.js";import{n as x}from"./commonFunction-rt4sErDP.js";import{t as S}from"./stores-DyR5nkVw.js";import{t as C}from"./LayoutLogin-v4ujrSaF.js";var w={for:`username`,class:`form__label form__label--whitMessage`},T={for:`password`,class:`form__label form__label--whitMessage`},E={class:`flex items-center justify-end`},D=y({__name:`LoginView`,setup(y){let D=g(),O=a(),k=c({account:`odt123`,password:`1q2w3e4r`}),A=_(()=>k.value.password.length<1||k.value.account.length<1),j=c(!1),M=e=>({account:[k.value.account.length<1?`請輸入帳號`:``].join(` `).trim(),password:[k.value.password.length<1?`請輸入密碼`:``].join(` `).trim()})[e],N=S(),P=c(!1),F=async()=>{if(A.value){j.value=!0;return}else j.value=!1;try{P.value=!0;let{data:e}=(await i.AUTH.POST_LOGIN(k.value)).data,t=crypto.randomUUID();return sessionStorage.setItem(`z2y8x4w6v1u9`,t),sessionStorage.setItem(`a7b3c9d1e5f8`,x(e,t)),N.updateUser(),P.value=!1,O.push({name:`Index`})}catch(e){let{response:t}=e;D.add({severity:`error`,summary:`登入異常`,detail:t.data.message,life:3e3}),P.value=!1}};return(i,a)=>(h(),f(C,null,{form:o(()=>[s(`form`,{class:`wrap--gap flex flex-col`,onSubmit:u(F,[`prevent`])},[b(l(t),{variant:`on`},{default:o(()=>[b(l(e),{id:`username`,fluid:``,autocomplete:`true`,invalid:j.value&&M(`account`).length>0,modelValue:k.value.account,"onUpdate:modelValue":a[0]||=e=>k.value.account=e},null,8,[`invalid`,`modelValue`]),s(`label`,w,[a[3]||=s(`i`,{class:`bi bi-person`},null,-1),a[4]||=s(`span`,null,`帳號`,-1),j.value&&M(`account`).length>0?(h(),f(l(r),{key:0,severity:`error`,variant:`simple`,size:`small`,pt:{text:{class:`!text-[0.625rem]`}}},{default:o(()=>[m(v(M(`account`)),1)]),_:1})):d(``,!0)])]),_:1}),b(l(t),{variant:`on`},{default:o(()=>[b(l(n),{inputId:`password`,fluid:``,feedback:!1,toggleMask:``,inputProps:{autocomplete:`false`},invalid:j.value&&M(`password`).length>0,modelValue:k.value.password,"onUpdate:modelValue":a[1]||=e=>k.value.password=e},null,8,[`invalid`,`modelValue`]),s(`label`,T,[a[5]||=s(`i`,{class:`bi bi-key`},null,-1),a[6]||=s(`span`,null,`密碼`,-1),j.value&&M(`password`).length>0?(h(),f(l(r),{key:0,severity:`error`,variant:`simple`,size:`small`,pt:{text:{class:`!text-[0.625rem]`}}},{default:o(()=>[m(v(M(`password`)),1)]),_:1})):d(``,!0)])]),_:1}),s(`div`,E,[b(l(p),{size:`small`,text:``,severity:`secondary`,pt:{root:{class:`text-xs!`}},label:`會員註冊`,onClick:a[2]||=e=>l(O).push({name:`Register`})})]),b(l(p),{type:`submit`,label:`登入`,loading:P.value},null,8,[`loading`])],32)]),_:1}))}});export{D as default};